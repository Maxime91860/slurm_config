# slurm.conf file generated by configurator.html.
# Put this file on all nodes of your cluster.
# See the slurm.conf man page for more information.

# Slurm controller
ClusterName=cluster_test
ControlMachine=master
#ControlAddr=
#BackupController=
#BackupAddr=


SlurmUser=slurm.user
SlurmctldPort=6817
SlurmdPort=6818
AuthType=auth/munge
CryptoType=crypto/munge
CacheGroups=1


#MailProg=/bin/mail


TaskPlugin=task/cgroup
TaskPluginParam=Cores,Sched
MaxTasksPerNode=1


# Slurm repertories
SlurmdSpoolDir=/var/spool/slurmd

SlurmctldPidFile=/var/run/slurm/slurmctld.pid
SlurmctldLogFile=/var/log/slurm/slurmctld.log
SlurmSchedLogFile=/var/log/slurm/slurmsched.log

SlurmdLogFile=/var/log/slurm/nodes/%h.log
SlurmdPidFile=/var/run/slurm/slurmd.pid

StateSaveLocation=/var/spool/slurm


SlurmdDebug=3
SlurmctldDebug=5
DebugFlags=Backfill,Energy,Gres,NO_CONF_HASH,Priority,Steps,CPU_Bind,JobContainer,License,Protocol,TraceJobs
SlurmSchedLogLevel=1
SwitchType=switch/none

# Job submit
JobSubmitPlugins=job_submit/lua 

## Priority
PriorityType=priority/multifactor
PriorityDecayHalfLife=14-0
PriorityFavorSmall=YES
PriorityMaxAge=14-0	  

PriorityWeightAge=10000       # Give to jobs
PriorityWeightFairshare=4000  # Enabled fairshare
PriorityWeightJobSize=8000    # Favorise small jobs, if 0 : favorise large jobs
PriorityWeightQOS=5000        # Heavy use of the QoS
PriorityWeightPartition=1000  # Partition priority

## OTHERS
# SOME
MpiDefault=none
ReturnToService=1
FastSchedule=2

# Auth
UsePAM=1

# SERVICE
MaxJobCount=50000
AccountingStorageEnforce=limits,qos
PropagateResourceLimits=ALL
PropagateResourceLimitsExcept=MEMLOCK

# TIMERS
SlurmdTimeout=300
MinJobAge=10
InactiveLimit=1800
MessageTimeout=80
KillWait=30
Waittime=30


# LOGGING AND ACCOUNTING
AccountingStorageType=accounting_storage/mysql
AccountingStorageHost=master
AccountingStoragePort=3306
AccountingStorageUser=slurm.user
AccountingStoreJobComment=YES
JobAcctGatherFrequency=30
JobAcctGatherType=jobacct_gather/cgroup
JobCompLoc=/var/log/slurm/jobs.log
JobCompType=jobcomp/filetxt


# COMPUTE NODES
NodeName=node[1-4] CPUs=1 RealMemory=1200 Sockets=1 CoresPerSocket=1 ThreadsPerCore=1 State=UNKNOWN

# PARTITION
PartitionName=compute Nodes=node[1-4] Default=YES MaxTime=INFINITE State=UP

#CheckpointType=checkpoint/none
#DisableRootJobs=NO
#EnforcePartLimits=NO
#Epilog=
#EpilogSlurmctld=
#FirstJobId=1
#MaxJobId=999999
#GresTypes=
#GroupUpdateForce=0
#GroupUpdateTime=600
#JobCheckpointDir=/var/slurm/checkpoint
#JobCredentialPrivateKey=
#JobCredentialPublicCertificate=
#JobFileAppend=0
#JobRequeue=1
#JobSubmitPlugins=1
#KillOnBadExit=0
#LaunchType=launch/slurm
#Licenses=foo*4,bar
#MaxJobCount=5000
#MaxStepCount=40000
#MpiDefault=none
#MpiParams=ports=#-#
#PluginDir=
#PlugStackConfig=
#PrivateData=jobs
#ProctrackType=proctrack/cgroup
#Prolog=
#PrologFlags=
#PrologSlurmctld=
#PropagatePrioProcess=0
#PropagateResourceLimits=
#PropagateResourceLimitsExcept=
#RebootProgram=
#ReturnToService=1
#SallocDefaultCommand=
#SlurmdUser=root
#SrunEpilog=
#SrunProlog=
#TaskEpilog=
#TaskProlog=
#TopologyPlugin=topology/tree
#TmpFS=/tmp
#TrackWCKey=no
#TreeWidth=
#UnkillableStepProgram=
#UsePAM=0


# TIMERS
#BatchStartTimeout=10
#CompleteWait=0
#EpilogMsgTime=2000
#GetEnvTimeout=2
#HealthCheckInterval=0
#HealthCheckProgram=
#InactiveLimit=0
#KillWait=30
#MessageTimeout=10
#ResvOverRun=0
#MinJobAge=300
#OverTimeLimit=0
#SlurmctldTimeout=120
#SlurmdTimeout=300
#UnkillableStepTimeout=60
#VSizeFactor=0
#Waittime=10


# SCHEDULING
#DefMemPerCPU=0
#FastSchedule=1
#MaxMemPerCPU=0
#SchedulerTimeSlice=30
#SchedulerType=sched/backfill
#SelectType=select/cons_res
#SelectTypeParameters=CR_CORE_Memory


# JOB PRIORITY
#PriorityFlags=
#PriorityType=priority/basic
#PriorityDecayHalfLife=
#PriorityCalcPeriod=
#PriorityFavorSmall=
#PriorityMaxAge=
#PriorityUsageResetPeriod=
#PriorityWeightAge=
#PriorityWeightFairshare=
#PriorityWeightJobSize=
#PriorityWeightPartition=
#PriorityWeightQOS=



# POWER SAVE SUPPORT FOR IDLE NODES (optional)
#SuspendProgram=
#ResumeProgram=
#SuspendTimeout=
#ResumeTimeout=
#ResumeRate=
#SuspendExcNodes=
#SuspendExcParts=
#SuspendRate=
#SuspendTime=


# LOGGING AND ACCOUNTING
#AccountingStorageEnforce=0
#AccountingStorageLoc=/var/log/slurm
#AccountingStoragePass=password
#DebugFlags=
#JobCompHost=master
#JobCompLoc=/var/log/slurm
#JobCompPass=password
#JobCompPort=3306
#JobCompUser=slurm.user
#JobContainerType=job_container/none


